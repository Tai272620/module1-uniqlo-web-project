<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <link rel="stylesheet" href="../assets/css/login.css">
</head>

<body>
    <header class="header-login">
        <div class="logo">
            <a href="../index.html"><img src="../assets/images/uniqlo-logo-vector.png" alt=""></a>
        </div>
    </header>

    <div class="login-container">
        <form class="login-form" method="POST" id="form-2">
            <h2>Log in</h2>
            <p>Sign in with your email address and password.</p>
            <div class="form-group">
                <label for="email">EMAIL ADDRESS</label><br>
                <input id="email" name="email" type="text" placeholder="Enter a valid email" class="form-control"><br>
                <span class="form-message"></span>
            </div>
            <div class="form-group">
                <label for="password">PASSWORD</label><br>
                <input id="password" name="password" type="text" class="form-control"><br>
                <span class="form-message"></span>
            </div>
            <span class="text">Password must be at least 8 characters and contain both letters and numbers.</span><br>
            <input type="checkbox" class="showPassword">
            <span>Show password</span><br>
            <a href="#">TERMS OF USE</a><br>
            <a href="#">PRIVACY POLICY</a><br>
            <button id="loginButton" onclick="loginUser()" class="form-submit">Log in</button><br>
            <a href="#">FORGOT YOUR PASSWORD?</a>
        </form>
        <div class="register-form">
            <h2>Create an account</h2>
            <p>Create an account now! You can get special services for yourself such as checking your purchase history
                and getting member coupons. Sign up for free today!
            </p>
            <button class="registerButton" onclick="registerUser()">Register</button><br>
        </div>
    </div>
    <script>
        // function loginUser() {
        //     let listUsers = JSON.parse(localStorage.getItem("listUsers")) || [];
        //     let valueEmail = document.getElementById("email").value;
        //     let valuePassword = document.getElementById("password").value;

        //     for (let i = 0; i < listUsers.length; i++) {
        //         if (valueEmail == listUsers[i].email && valuePassword == listUsers[i].password) {
        //             console.log("Đăng nhập thành công");
        //             localStorage.setItem("checkLogin", listUsers[i].idUser);
        //             window.location.href = "home.html";
        //             return;
        //         }
        //     }
        //     alert("Tài khoản hoặc mật khẩu không đúng");
        // }

        function registerUser() {
            window.location.href = "register.html";
        }

        document.addEventListener('DOMContentLoaded', function () {
            // Mong muốn của chúng ta
            Validator({
                form: '#form-2',
                formGroupSelector: '.form-group',
                errorSelector: '.form-message',
                rules: [
                    Validator.isEmail('#email'),
                    Validator.minLength('#password', 6),
                ],
                onSubmit: function (data) {
                    // Call API
                    console.log(data);
                    let listUsers = JSON.parse(localStorage.getItem("listUsers")) || [];
                    let checkUser = listUsers.find((user) => {
                        return user.email === data.email && user.password === data.password
                    })
                    if (checkUser) {
                        window.location.href = "../index.html";
                        localStorage.setItem("checkLogin", checkUser.idUser);
                        return;
                    } else {
                        alert("User email or password is wrong");
                    }
                }
            });
        });
    </script>
    <script src="../assets/js/validator.js"></script>
</body>

</html>